# AZURE Buckets Managed By Terraform
Terraform code that creates and maintains infrastructure for stores, using Azure Blob Storage which is an object storage service provided by Azure in multiple geographical regions.
# Table of Contents
1. [Requirements](#requirements)
2. [Guides](#guides)
3. [State File](#state-file)
5. [Sensitive Data in State File](#sensitive-data-in-state-file)
6. [Terraform Backends](#terraform-backends-keep-state-file-secure)

# Guides
1. [How to Deploy Infrastructure](Create_Infrastructure.md)
2. [How to Get Values from output](Get_Outputs.md)
3. [How to Update Infrastructure](Update_Infrastructure.md)
4. [How to Import Existing Infrastructure](Import_Infrastructure.md)
5. [How to Destroy Infrastructure](Destroy_Infrastructure.md)


# Requirements

- Adding Azure as store options requires you to have a storage account with Microsoft Azure. This is where your data is stored in the containers (equivalent of buckets in AWS S3). You can start with the [free account](https://azure.microsoft.com/en-us/free/) for now.
- The [Terraform CLI](https://developer.hashicorp.com/terraform/tutorials/azure-get-started/install-cli) (1.2.0+) installed.
- The [Azure CLI](https://learn.microsoft.com/en-us/cli/azure/install-azure-cli) installed.
- [Terraform Basics](https://developer.hashicorp.com/terraform/tutorials/azure-get-started/azure-build)
- [Login to azure cli](https://learn.microsoft.com/en-us/cli/azure/get-started-with-azure-cli) terraform requires that azure cli and active token which is generated by login

## State File

When using Terraform it needs to keep track of the infrastructure it's creating. It does this by means of a [state](https://developer.hashicorp.com/terraform/language/state)file. This file is just a simple JSON file (though its extension is terraform.tfstate) that defines the infrastructure that has been created by Terraform and any proposed changes. By default, this file is stored on the local machine where terraform commands are run and should be checked into git or any other source code management system used. More of the purpose of the state file can be explained [here](https://developer.hashicorp.com/terraform/language/state/purpose). Terraform compares your configuration with the state file and your existing infrastructure to create plans and make changes to your infrastructure. When you run terraform apply or terraform destroy against your initialized configuration, Terraform writes metadata about your configuration to the state file and updates your infrastructure resources accordingly.

## Sensitive Data in State File

The state file can handle sensitive data, if creating storage_account with access key and connection string this will be stored in plain text in the state file. So recommend keeping state file [secure](https://developer.hashicorp.com/terraform/language/state/sensitive-data). 

# IMPORTANT TO KEEP STATE FILE SAFE

## Terraform Backends Keep State File Secure

If the state file is deleted terraform will lose track of the infrastructure it has created, so it is important to keep state file in safe place where it wont be deleted, like Terraform [backends](https://developer.hashicorp.com/terraform/language/settings/backends/configuration). Also since it is just a simple file, it can actually be edited by anyone that has access to it and this might cause unwanted behaviors in the state of your infrastructure. This is not ideal for collaboration as git conflicts may arise if multiple developers are modifying their own local copy of the file. Terraform introduce multiple online storage locations for this file called [backends](https://developer.hashicorp.com/terraform/language/settings/backends/configuration), and [AZURE](https://developer.hashicorp.com/terraform/language/settings/backends/azurerm) can be used as a backend to safely store your state file. 

<br />